/**
 * jeefo     : v0.0.24
 * Author    : je3f0o, <je3f0o@gmail.com>
 * Homepage  : https://github.com/je3f0o/jeefo
 * License   : The MIT License
 * Copyright : 2016
 **/
!function(){"use strict";var e=function(){var e=Array,n=e.isArray,t=Object.keys,r=function(e){for(var n,r,i,o=1;o<arguments.length;++o)if(n=arguments[o])for(r=t(n),i=r.length-1;i>=0;e[r[i]]=n[r[i]],--i);return e},i=function(e){throw new Error(e)},o=function(n,t){var r=[],o={};return function s(c,u){for(var a=u.length-1,f=new e(a+1),d=t(c);a>=0;f[a]=u[a],--a);for(f.push(c),o[c]=!0,a=0;a<d.length;++a)f.indexOf(d[a])>=0&&i("Circular dependency '"+d[a]+" is required by '"+n+"' : "+f.join(" -> ")),o.hasOwnProperty(d[a])||s(d[a],f);-1===r.indexOf(c)&&r.push(c)}(n,[]),r},s=function(e,n,t){function r(){return 0===h}function i(){return 2===h}function o(){return 1===h}function c(){return p}function u(e){if(0===h){h=1,y.state="resolved",y.value=p=e;for(var r=0;r<w;r+=4)e=l[r](p),e&&"JEEFO_PROMISE"===e.type?e.then(l[r+2],l[r+3]):l[r+2](e);l=null,w=0,v&&n&&n.apply(null,t)}}function a(e){if(0===h){h=2,y.state="rejected",y.reason=p=e;for(var r=1;r<w;r+=4)e=l[r](p),e&&"JEEFO_PROMISE"===e.type?e.then(l[r+1],l[r+2]):l[r+2](e);l=null,w=0,v&&n&&n.apply(null,t)}}function f(e,r){return v=!1,new s(function(n,t){switch(h){case 1:var i=e(p);return i&&"JEEFO_PROMISE"===i.type?i.then(n,t):n(i);case 2:return r?n(r(p)):t(p);default:l[w]=e||c,l[w+1]=r||c,l[w+2]=n,l[w+3]=t,w+=4}},n,t)}function d(e){return v=!1,new s(function(n,t){switch(h){case 1:return p&&"JEEFO_PROMISE"===p.type?p.then(n,t):n(p);case 2:return n(e(p));default:l[w]=c,l[w+1]=e,l[w+2]=n,l[w+3]=t,w+=4}},n,t)}var p,h=0,l=[],y=this,v=!0,w=0;y.then=f,y.state="pending...",y.$catch=d,y.result=c,y.is_pending=r,y.is_rejected=i,y.is_resolved=o;try{e(u,a)}catch(e){a(e)}return y};s.prototype.type="JEEFO_PROMISE";var c={defer:function(){var e={};return e.promise=new s(function(n,t){e.resolve=n,e.reject=t}),e},reject:function(e){return new s(function(n,t){t(e)})},when:function(e){return e&&"JEEFO_PROMISE"===e.type?e:new s(function(n){n(e)})},for_each_async:function(e,n){function t(){if(++i<e.length)try{n.call(e,e[i],i,t,r)}catch(e){r(e)}else o.resolve()}function r(e){o.reject(e)}var i=-1,o=this.defer();return t(),o.promise},all:function(e){for(var n,t=0,r=this.defer(),i=0;t<e.length;++t)(n=e[t])&&"JEEFO_PROMISE"===n.type&&(i+=1,n.then(function(n){return function(t){e[n]=t,0===--i&&r.resolve(e)}}(t)));return 0===i&&r.resolve(e),r.promise}},u=function(e){this.values={},this.instance=e,this.definitions={}},a=[];u.prototype={register:function(n,t){if(t.dependencies){for(var r=new e(t.dependencies.length),o=r.length-1;o>=0;r[o]=t.dependencies[o],--o);(this.values.hasOwnProperty(n)||this.definitions.hasOwnProperty(n))&&i("Duplicated provider "+n+" detected."),this.definitions[n]={fn:t.fn,dependencies:r,is_constructor:!!t.is_constructor}}else this.definitions[n]={fn:t.fn,dependencies:a,is_constructor:!!t.is_constructor};return this},resolve:function(n,t){var r,s=this.values,u=this.instance,a=this.definitions,f=t&&t.values||{},d=t&&t.definitions;return f.hasOwnProperty(n)?f[n]&&"JEEFO_PROMISE"===f[n].type?f[n]:c.when(f[n]):s.hasOwnProperty(n)?s[n]&&"JEEFO_PROMISE"===s[n].type?s[n]:c.when(s[n]):(r=o(n,function(e){return d&&d.hasOwnProperty(e)?d[e].dependencies:a.hasOwnProperty(e)?a[e].dependencies:void i("Injector '"+e+"' definition is not found.")}),c.for_each_async(r,function(n,t,r){var o,c;if(f.hasOwnProperty(n)||s.hasOwnProperty(n))return r();d&&d.hasOwnProperty(n)?(o=f,c=d[n]):(o=s,c=a[n]);for(var p=c.dependencies.length-1,h=new e(p+1);p>=0;--p)f.hasOwnProperty(c.dependencies[p])?h[p]=f[c.dependencies[p]]:s.hasOwnProperty(c.dependencies[p])?h[p]=s[c.dependencies[p]]:i("OMG");var l=c.fn.apply(u,h);c.is_constructor&&(l=new l),l&&"JEEFO_PROMISE"===l.type?l.then(function(e){o[n]=e,r()}):(o[n]=l,r())}).then(function(){return f.hasOwnProperty(n)?f[n]:s[n]}))},resolve_sync:function(n,t){var r,s=this.values,c=t&&t.values||{},u=this.definitions,a=t&&t.definitions;if(c.hasOwnProperty(n))return c[n];if(s.hasOwnProperty(n))return s[n];a&&a.hasOwnProperty(n)?r=c:u.hasOwnProperty(n)&&(r=s);for(var f=o(n,function(e){return a&&a.hasOwnProperty(e)?a[e].dependencies:u.hasOwnProperty(e)?u[e].dependencies:void i("Injector '"+e+"' definition is not found.")}),d=u[f.pop()],p=new e(d.dependencies.length),h=0;h<f.length;++h)c.hasOwnProperty(f[h])||s.hasOwnProperty(f[h])||this.resolve_sync(f[h],t);for(h=p.length-1;h>=0;--h)p[h]=c.hasOwnProperty(d.dependencies[h])?c[d.dependencies[h]]:s[d.dependencies[h]];return r[n]=d.fn.apply(this.instance,p)}};var f=function(e,n,t,r){function o(e){return"$injector"===e||p.hasOwnProperty(e)||d.hasOwnProperty(e)}function s(t,s){return o(t)&&i("Duplicated provider '"+t+"' detected in module '"+e+"'."),n.register(t,s),r[t]=n.definitions[t],f}function u(r){return p.hasOwnProperty(r)?c.when(p[r]):d.hasOwnProperty(r)?n.resolve(r,t):void i("Module provider '"+r+"' definition is not found in '"+e+"' module.")}function a(r){return p.hasOwnProperty(r)?p[r]:d.hasOwnProperty(r)?n.resolve_sync(r,t):void i("Module provider '"+r+"' definition is not found in '"+e+"' module.")}var f=this,d=n.definitions,p=t.values;return f.has=o,f.resolve=u,f.register=s,f.resolve_sync=a,f},d={dependencies:a},p=function(n,t,r){if("function"===typeof t)return{fn:t,name:n,dependencies:a};if("string"===typeof t)return{fn:r,name:n,dependencies:[t]};for(var i=t.length-1,o=new e(i+1);i>=0;o[i]=t[i],--i);return{fn:r,name:n,dependencies:o}},h={values:{$q:c,Array:e,is_array:n,Injector:u,JeefoPromise:s,"object.keys":t,"object.assign":r,make_injectable:p,"sorts.topological":o},definitions:{$q:d,Array:d,is_array:d,Injector:d,JeefoPromise:d,"object.keys":d,"object.assign":d,make_injectable:d,"sorts.topological":d}},l=function(n,t,s){function d(){return j}function l(){var e=arguments[0],t=p.apply(null,arguments);return O.hasOwnProperty(e)&&i("'"+e+"' extends already registered in '"+n+"' module."),_[E++]=t,y(O,t),O}function y(n,t){var r=new e(t.dependencies.length);c.for_each_async(t.dependencies,function(e,n,t,i){j.resolve(e).then(function(e){r[n]=e,t()}).$catch(i)}).then(function(){n[t.name]=t.fn.apply(n,r)}).$catch(function(e){console.error(e)})}var v,w,O={$name:n,extend:l},P=new u(O),_=[],E=0,g={},j=new f(n,P,h,g),m=[];for(w=o(n,function(e){return s[e]?s[e].requires:n===e?t:void i("'"+e+"' module is not found.")}),w.pop(),O.$included_modules=w,v=0;v<w.length;++v)m=m.concat(s[w[v]].extenders),r(P.definitions,s[w[v]].new_definitions);for(P.definitions.$injector={fn:d,dependencies:a},s[n]={name:n,requires:t,instance:O,injector:P,extenders:_,public_injector:j,new_definitions:g},v=0;v<m.length;++v)y(O,m[v]);return O},y=function(){};return y.prototype={use:function(e){return e(this),this}},{create:function(){function e(e,r){return n(r)?(t.hasOwnProperty(e)&&i("Duplicated module '"+e+"' is detected."),l(e,r,t)):(t.hasOwnProperty(e)||i("'"+e+"' module is not found."),t[e].instance)}var t={},r=new y;return r.module=e,r}}}();window.jeefo=e.create()}();