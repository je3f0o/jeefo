/**
 * jeefo     : v0.0.20
 * Author    : je3f0o, <je3f0o@gmail.com>
 * Homepage  : https://github.com/je3f0o/jeefo
 * License   : The MIT License
 * Copyright : 2016
 **/
"use strict";module.exports=function(){var e=Array,n=e.isArray,r=Object.keys,t=function(e){for(var n,t,i,o=1;o<arguments.length;++o)if(n=arguments[o])for(t=r(n),i=t.length-1;i>=0;e[t[i]]=n[t[i]],--i);return e},i=function(e){throw new Error(e)},o=function(n,r){var t=[],o={};return function s(u,c){for(var d=c.length-1,f=new e(d+1),a=r(u);d>=0;f[d]=c[d],--d);for(f.push(u),o[u]=!0,d=0;d<a.length;++d)f.indexOf(a[d])>=0&&i("Circular dependency '"+a[d]+" is required by '"+n+"' : "+f.join(" -> ")),o.hasOwnProperty(a[d])||s(a[d],f);-1===t.indexOf(u)&&t.push(u)}(n,[]),t},s=function(e){function n(){return 0===i}function r(e,n){return new s(function(r,s){switch(i){case 1:return r(e(t));case 2:return s(n(t));default:o[c]=e,o[c+1]=n,o[c+2]=r,o[c+3]=s,c+=4}})}var t,i=0,o=[],u=this,c=0;return u.then=r,u.state="pending...",u.is_pending=n,e(function(e){if(0===i){i=1,u.state="resolved",u.value=t=e;for(var n=0;n<c;n+=4)e=o[n](t),e&&"JEEFO_PROMISE"===e.type?e.then(o[n+2],o[n+3]):o[n+2](e);o=null,c=0}},function(e){if(0===i){i=2,u.state="rejected",u.reason=t=e;for(var n=1;n<c;n+=4)e=o[n](t),e&&"JEEFO_PROMISE"===e.type?e.then(o[n+1],o[n+2]):o[n+2](e);o=null,c=0}}),u};s.prototype.type="JEEFO_PROMISE";var u={defer:function(){var e={};return e.promise=new s(function(n,r){e.resolve=n,e.reject=r}),e},when:function(e){return e&&"JEEFO_PROMISE"===e.type?e:new s(function(n){n(e)})},for_each_async:function(e,n){function r(){++t<e.length?n.call(e,e[t],t,r,e):i.resolve()}var t=-1,i=this.defer();return r(),i.promise},all:function(e){for(var n,r=0,t=this.defer(),i=0;r<e.length;++r)(n=e[r])&&"JEEFO_PROMISE"===n.type&&(i+=1,n.then(function(n){return function(r){e[n]=r,0===--i&&t.resolve(e)}}(r)));return 0===i&&t.resolve(e),t.promise}},c=function(e){this.values=t({},e),this.definitions={}},d=[];c.prototype={register:function(n,r){if(r.dependencies){for(var t=new e(r.dependencies.length),o=t.length-1;o>=0;t[o]=r.dependencies[o],--o);(this.values.hasOwnProperty(n)||this.definitions.hasOwnProperty(n))&&i("Duplicated provider "+n+" detected."),this.definitions[n]={fn:r.fn,dependencies:t,is_constructor:!!r.is_constructor}}else this.definitions[n]={fn:r.fn,dependencies:d,is_constructor:!!r.is_constructor};return this},resolve:function(n,r){var t,s=this.values,c=this.definitions,d=r&&r.values||{},f=r&&r.definitions;return d.hasOwnProperty(n)?d[n]&&"JEEFO_PROMISE"===d[n].type?d[n]:u.when(d[n]):s.hasOwnProperty(n)?s[n]&&"JEEFO_PROMISE"===s[n].type?s[n]:u.when(s[n]):(t=o(n,function(e){return f&&f.hasOwnProperty(e)?f[e].dependencies:c.hasOwnProperty(e)?c[e].dependencies:void i("Injector '"+e+"' definition is not found.")}),u.for_each_async(t,function(n,r,t){var o,u;if(d.hasOwnProperty(n)||s.hasOwnProperty(n))return t();f&&f.hasOwnProperty(n)?(o=d,u=f[n]):(o=s,u=c[n]);for(var a=u.dependencies.length-1,p=new e(a+1);a>=0;--a)d.hasOwnProperty(u.dependencies[a])?p[a]=d[u.dependencies[a]]:s.hasOwnProperty(u.dependencies[a])?p[a]=s[u.dependencies[a]]:i("OMG");var h=u.fn.apply(null,p);u.is_constructor&&(h=new h),h&&"JEEFO_PROMISE"===h.type?h.then(function(e){o[n]=e,t()}):(o[n]=h,t())}).then(function(){return d.hasOwnProperty(n)?d[n]:s[n]}))},resolve_sync:function(n,r){var t,s=this,u=s.values,c=r&&r.values||{},d=s.definitions,f=r&&r.definitions;if(c.hasOwnProperty(n))return c[n];if(u.hasOwnProperty(n))return u[n];f&&f.hasOwnProperty(n)?t=c:d.hasOwnProperty(n)&&(t=u);for(var a=o(n,function(e){return f&&f.hasOwnProperty(e)?f[e].dependencies:d.hasOwnProperty(e)?d[e].dependencies:void i("Injector '"+e+"' definition is not found.")}),p=d[a.pop()],h=new e(p.dependencies.length),l=0;l<a.length;++l)c.hasOwnProperty(a[l])||u.hasOwnProperty(a[l])||s.resolve_sync(a[l],r);for(l=h.length-1;l>=0;--l)h[l]=c.hasOwnProperty(p.dependencies[l])?c[p.dependencies[l]]:u[p.dependencies[l]];return t[n]=p.fn.apply(null,h)}};var f=function(e,n,r,t){function o(e){return"$injector"===e||p.hasOwnProperty(e)||a.hasOwnProperty(e)}function s(r,s){return o(r)&&i("Duplicated provider '"+r+"' detected in module '"+e+"'."),n.register(r,s),t[r]=n.definitions[r],f}function c(t){return p.hasOwnProperty(t)?u.when(p[t]):a.hasOwnProperty(t)?n.resolve(t,r):void i("Module provider '"+t+"' definition is not found in '"+e+"' module.")}function d(t){return p.hasOwnProperty(t)?p[t]:a.hasOwnProperty(t)?n.resolve_sync(t,r):void i("Module provider '"+t+"' definition is not found in '"+e+"' module.")}var f=this,a=n.definitions,p=r.values;return f.has=o,f.resolve=c,f.register=s,f.resolve_sync=d,f},a={dependencies:d},p=function(n,r,t){if("function"===typeof r)return{fn:r,name:n,dependencies:d};if("string"===typeof r)return{fn:t,name:n,dependencies:[r]};for(var i=r.length-1,o=new e(i+1);i>=0;o[i]=r[i],--i);return{fn:t,name:n,dependencies:o}},h={values:{$q:u,Array:e,is_array:n,Injector:c,"object.keys":r,"object.assign":t,make_injectable:p,"sorts.topological":o},definitions:{$q:a,Array:a,is_array:a,Injector:a,"object.keys":a,"object.assign":a,make_injectable:a,"sorts.topological":a}},l=function(n,r,s){function a(){return m}function l(){var e=arguments[0],r=p.apply(null,arguments);return O.hasOwnProperty(e)&&i("'"+e+"' extends already registered in '"+n+"' module."),_[g++]=r,y(O,r),O}function y(n,r){var t=new e(r.dependencies.length);u.for_each_async(r.dependencies,function(e,n,r){m.resolve(e).then(function(e){t[n]=e,r()})}).then(function(){n[r.name]=r.fn.apply(n,t)})}var v,w,O={$name:n,extend:l},P=new c,_=[],g=0,E={},m=new f(n,P,h,E),j=[];for(w=o(n,function(e){return s[e]?s[e].requires:n===e?r:void i("'"+e+"' module is not found.")}),w.pop(),O.$included_modules=w,v=0;v<w.length;++v)j=j.concat(s[w[v]].extenders),t(P.definitions,s[w[v]].new_definitions);for(P.definitions.$injector={fn:a,dependencies:d},s[n]={name:n,requires:r,instance:O,injector:P,extenders:_,public_injector:m,new_definitions:E},v=0;v<j.length;++v)y(O,j[v]);return O},y=function(){};return y.prototype={use:function(e){return e(this),this}},{create:function(){function e(e,t){return n(t)?(r.hasOwnProperty(e)&&i("Duplicated module '"+e+"' is detected."),l(e,t,r)):(r.hasOwnProperty(e)||i("'"+e+"' module is not found."),r[e].instance)}var r={},t=new y;return t.module=e,t}}}();